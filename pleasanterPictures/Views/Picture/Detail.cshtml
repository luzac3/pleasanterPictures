@using pleasanterPictures.Models.ViewModel
@model PictureViewModel

@{
    ViewData["Title"] = "Picture";
}
@section Scripts {
    <script src="~/js/PictureUser.js" defer></script>
    <link rel="stylesheet" href="~/css/Picture/Index.css" asp-append-version="true" />
}
<div id="picture">
    @if (Model.PictureEntity != null)
    {
        <p>番号：@(Model.PictureEntity?.ResultId)</p>
        <input id="picture_id" type="text" class="nodisplay" value="@(Model.PictureEntity?.ResultId)" />
        <p>@(Model.PictureEntity?.Picture)</p>

        @if (!string.IsNullOrEmpty(Model.PictureEntity?.PictureImage))
        {
            <div>
                <img src="@Url.Action("GetImage", "Picture", new { resultId = Model.PictureEntity?.ResultId, type = "main" })" 
                     class="picture_image"
                     style="max-width: 100%; height: auto;" />
            </div>
        }
    }
</div>
<div id="answer_container">
    <div class="drawing-tools">
        <div class="tools-section">
            <div class="tool-buttons">
                <button id="tool-pen" class="tool-button active" title="ペン">
                    <span class="material-symbols-outlined">edit</span>
                </button>
                <button id="tool-eraser" class="tool-button" title="消しゴム">
                    <span class="material-symbols-outlined">cleaning_services</span>
                </button>
                <button id="tool-undo" class="tool-button" title="元に戻す" disabled>
                    <span class="material-symbols-outlined">undo</span>
                </button>
            </div>
        </div>

        @if (!string.IsNullOrEmpty(Model.PictureEntity?.PictureImageOverlay))
        {
            <div class="color-palette">
                <div class="color-palette-label">線の色：</div>
                <div class="color-palette-colors">
                    <button class="color-button" data-color="#000000" style="background-color: #000000;" title="黒"></button>
                    <button class="color-button" data-color="#FFFFFF" style="background-color: #FFFFFF; border: 1px solid #ccc;" title="白"></button>
                    <button class="color-button" data-color="#FF0000" style="background-color: #FF0000;" title="赤"></button>
                    <button class="color-button" data-color="#00FF00" style="background-color: #00FF00;" title="緑"></button>
                    <button class="color-button" data-color="#0000FF" style="background-color: #0000FF;" title="青"></button>
                    <button class="color-button" data-color="#FFFF00" style="background-color: #FFFF00;" title="黄"></button>
                    <button class="color-button" data-color="#FF00FF" style="background-color: #FF00FF;" title="マゼンタ"></button>
                    <button class="color-button" data-color="#00FFFF" style="background-color: #00FFFF;" title="シアン"></button>
                    <button class="color-button" data-color="#FFA500" style="background-color: #FFA500;" title="オレンジ"></button>
                    <button class="color-button" data-color="#800080" style="background-color: #800080;" title="紫"></button>
                    <button class="color-button" data-color="#FFC0CB" style="background-color: #FFC0CB;" title="ピンク"></button>
                    <button class="color-button" data-color="#808080" style="background-color: #808080;" title="グレー"></button>
                </div>
            </div>

            <div class="picture_canvas_wrapper">
                <div class="picture_canvas_container" style="width: auto; display: inline-block; position: relative;">
                    <img
                        id="picture_image_overlay"
                        src="@Url.Action("GetImage", "Picture", new { resultId = Model.PictureEntity?.ResultId, type = "overlay" })"
                        class="picture_image_overlay"
                        data-width="@(Model.PictureEntity?.PictureImageOverlayWidth)"
                        data-height="@(Model.PictureEntity?.PictureImageOverlayHeight)"
                        style="max-width: 100%; height: auto; display: block;"
                    />
                    <canvas
                        id="picture_canvas_overlay"
                        class="picture_canvas_overlay"
                        style="position: absolute; top: 0; left: 0;"
                    ></canvas>
                </div>
            </div>
        }
        else
        {
            <canvas id="textCanvas"></canvas>
        }
    <div class="picture-buttons">
        <button id="clear">クリア</button>
        <button id="send" @(Model.PictureEntity != null ? "" : "disabled")>確定</button>
    </div>
</div>
<div>
    <br /><button id="back" type="button">戻る</button>
</div>